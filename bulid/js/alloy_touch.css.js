!function(){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});for(var t=["webkit","moz"],i=0;i<t.length&&!window.requestAnimationFrame;++i){var e=t[i];window.requestAnimationFrame=window[e+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var s=0;window.requestAnimationFrame=function(t){var i=Date.now(),e=Math.max(s+16,i);return setTimeout(function(){t(s=e)},e-i)},window.cancelAnimationFrame=clearTimeout}}(),function(){function t(t){return 1-Math.sqrt(1-t*t)}function i(t,i,e){t.addEventListener(i,e,!1)}function e(t,i,e){t.removeEventListener(i,e)}function s(t,i){for(var e in i)if(i[e].test(t[e]))return!0;return!1}var n,h,a,o,r=document.createElement("div").style;if("transform"in r)o="transform",n="transitionend",h="transitionDuration",a="transitionTimingFunction";else{if(!("webkitTransform"in r))throw"please use a modern browser";o="webkitTransform",n="webkitTransitionEnd",h="webkitTransitionDuration",a="webkitTransitionTimingFunction"}var c="cubic-bezier(0.1, 0.57, 0.1, 1)",l=function(t){if(this.scroller=t.target,this.element="string"==typeof t.touch?document.querySelector(t.touch):t.touch,this.vertical=this._getValue(t.vertical,!0),this.property=t.property,this.preventDefault=this._getValue(t.preventDefault,!0),this.sensitivity=this._getValue(t.sensitivity,1),this.lockDirection=this._getValue(t.lockDirection,!0),this.initialValue=this._getValue(t.initialValue,this.scroller[this.property]),this.scroller[this.property]=this.initialValue,this.moveFactor=this._getValue(t.moveFactor,1),this.factor=this._getValue(t.factor,1),this.outFactor=this._getValue(t.outFactor,.3),this.min=t.min,this.max=t.max,this.maxRegion=this._getValue(t.maxRegion,60),this.deceleration=6e-4,this.maxRegion=this._getValue(t.maxRegion,600),this.springMaxRegion=this._getValue(t.springMaxRegion,60),this.change=t.change||function(){},this.touchEnd=t.touchEnd||function(){},this.touchStart=t.touchStart||function(){},this.touchMove=t.touchMove||function(){},this.touchCancel=t.touchMove||function(){},this.animationEnd=t.animationEnd||function(){},this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(void 0===this.min),this.hasMax=!(void 0===this.max),this.isTouchStart=!1,this.step=t.step,this.inertia=this._getValue(t.inertia,!0),this.maxSpeed=t.maxSpeed,this.hasMaxSpeed=!(void 0===this.maxSpeed),this.hasMax&&this.hasMin){if(this.min>this.max)throw"min value can't be greater than max value";this.currentPage=Math.round((this.max-this.scroller[this.property])/this.step)}this._startHandler=this._start.bind(this),this._moveHandler=this._move.bind(this),this._transitionEndHandler=this._transitionEnd.bind(this),this._endHandler=this._end.bind(this),this._cancelHandler=this._cancel.bind(this),i(this.element,"touchstart",this._startHandler),i(this.scroller,n,this._transitionEndHandler),i(window,"touchmove",this._moveHandler),i(window,"touchend",this._endHandler),i(window,"touchcancel",this._cancelHandler),this._endCallbackTag=!0,this._endTimeout=null};l.prototype={_getValue:function(t,i){return void 0===t?i:t},_transitionEnd:function(){if(this._triggerTransitionEnd){var t=this.scroller[this.property];t<this.min?this.to(this.min,600,c):t>this.max?this.to(this.max,600,c):this.step?(this.correction(),this._endCallbackTag&&(this._endTimeout=setTimeout(function(){this.animationEnd.call(this,t),cancelAnimationFrame(this.tickID)}.bind(this),400),this._endCallbackTag=!1)):(this.animationEnd.call(this,t),cancelAnimationFrame(this.tickID))}},_cancelAnimation:function(){this.scroller.style[h]="0ms",this.scroller[this.property]=this.getComputedPosition()},getComputedPosition:function(){var t=window.getComputedStyle(this.scroller,null);return t=t[o].split(")")[0].split(", "),this.vertical?+(t[13]||t[5]):+(t[12]||t[4])},_tick:function(){this.change.call(this,this.getComputedPosition()),this.tickID=requestAnimationFrame(this._tick.bind(this))},_start:function(t){cancelAnimationFrame(this.tickID),this._tick(),this._endCallbackTag=!0,this.isTouchStart=!0,this._firstTouchMove=!0,this._preventMove=!1,this.touchStart.call(this,t,this.scroller[this.property]),this._cancelAnimation(),clearTimeout(this._endTimeout),this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.scroller[this.property])/this.step)),this.startTime=(new Date).getTime(),this._startX=this.preX=t.touches[0].pageX,this._startY=this.preY=t.touches[0].pageY,this.start=this.vertical?this.preY:this.preX},_move:function(t){if(this.isTouchStart){var i=Math.abs(t.touches[0].pageX-this._startX),e=Math.abs(t.touches[0].pageY-this._startY);if(this._firstTouchMove&&this.lockDirection){var n=i-e;n>0&&this.vertical?this._preventMove=!0:n<0&&!this.vertical&&(this._preventMove=!0),this._firstTouchMove=!1}if(i<10&&e<10)return;if(!this._preventMove){var h=this.moveFactor,a=(this.vertical?t.touches[0].pageY-this.preY:t.touches[0].pageX-this.preX)*this.sensitivity;this.hasMax&&this.scroller[this.property]>this.max&&a>0?h=this.outFactor:this.hasMin&&this.scroller[this.property]<this.min&&a<0&&(h=this.outFactor),a*=h,this.preX=t.touches[0].pageX,this.preY=t.touches[0].pageY,this.scroller[this.property]+=a;var o=(new Date).getTime();o-this.startTime>300&&(this.startTime=o,this.start=this.vertical?this.preY:this.preX),this.touchMove.call(this,t,this.scroller[this.property])}this.preventDefault&&!s(t.target,this.preventDefaultException)&&t.preventDefault()}},_end:function(i){if(this.isTouchStart){var e=this,s=this.scroller[this.property];if(!1===this.touchEnd.call(this,i,s))return this._triggerTransitionEnd=!1,void cancelAnimationFrame(this.tickID);if(this._triggerTransitionEnd=!0,this.hasMax&&s>this.max)this.to(this.max,600,c);else if(this.hasMin&&s<this.min)this.to(this.min,600,c);else if(this.inertia&&!this._preventMove){var n=(new Date).getTime()-this.startTime;if(n<300){var h=((this.vertical?i.changedTouches[0].pageY:i.changedTouches[0].pageX)-this.start)*this.sensitivity,a=Math.abs(h)/n,o=this.factor*a;this.hasMaxSpeed&&o>this.maxSpeed&&(o=this.maxSpeed);var r=s+o*o/(2*this.deceleration)*(h<0?-1:1),l=1;r<this.min?r<this.min-this.maxRegion?(l=t((s-this.min+this.springMaxRegion)/(s-r)),r=this.min-this.springMaxRegion):(l=t((s-this.min+this.springMaxRegion*(this.min-r)/this.maxRegion)/(s-r)),r=this.min-this.springMaxRegion*(this.min-r)/this.maxRegion):r>this.max&&(r>this.max+this.maxRegion?(l=t((this.max+this.springMaxRegion-s)/(r-s)),r=this.max+this.springMaxRegion):(l=t((this.max+this.springMaxRegion*(r-this.max)/this.maxRegion-s)/(r-s)),r=this.max+this.springMaxRegion*(r-this.max)/this.maxRegion));var m=Math.round(a/e.deceleration)*l;e.to(Math.round(r),m,c)}else e.step&&e.correction()}else e.step&&e.correction();this.isTouchStart=!1}},_cancel:function(t){cancelAnimationFrame(this.tickID),this.step&&this.correction(),this.touchCancel.call(this,t)},to:function(t,i,e){var s=this.scroller,n=this.property;s.style[h]=this._getValue(i,600)+"ms",s.style[a]=e||c,s[n]=t},correction:function(){var t,i=window.getComputedStyle(this.scroller)[o],e=this.vertical?parseInt(i.split(",")[13]):parseInt(i.split(",")[12]),s=Math.floor(Math.abs(e/this.step)),n=e%this.step;Math.abs(n)>this.step/2?((t=(e<0?-1:1)*(s+1)*this.step)>this.max&&(t=this.max),t<this.min&&(t=this.min),this.to(t,400,c)):((t=(e<0?-1:1)*s*this.step)>this.max&&(t=this.max),t<this.min&&(t=this.min),this.to(t,400,c))},destroy:function(){e(this.element,"touchstart",this._startHandler),e(this.scroller,n,this._transitionEndHandler),e(window,"touchmove",this._moveHandler),e(window,"touchend",this._endHandler),e(window,"touchcancel",this._cancelHandler)}},"undefined"!=typeof module&&"object"==typeof exports?module.exports=l:window.AlloyTouch=l}();